<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dika ID - Solusi Digital Cepat & Aman</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg-color: #fff;
  --text-color: #000;
  --accent-color: #007BFF;
  --card-bg: #f9f9f9;
  --footer-bg: #f0f0f0;
  --popup-bg: #fff;
}
body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background-color: var(--bg-color);
  color: var(--text-color);
  transition: background-color 0.3s, color 0.3s;
}
header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 2rem;
  background: var(--accent-color);
  color: white;
  box-shadow: 0 2px 10px rgba(0,0,0,0.2);
}
.theme-toggle {
  cursor: pointer;
  font-size: 1.5rem;
  transition: transform 0.3s;
}
.theme-toggle:hover {
  transform: scale(1.2);
}
.container {
  padding: 2rem;
  max-width: 1000px;
  margin: auto;
}
.section {
  margin-top: 3rem;
  border-top: 2px solid #ddd;
  padding-top: 2rem;
}
.profile {
  background: var(--card-bg);
  padding: 1.5rem;
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  max-width: 900px;
  margin: 2rem auto;
  overflow: hidden;
}

.profile-header {
  text-align: center;
  margin-bottom: 1rem;
}

.profile-header h2 {
  margin: 0;
  font-size: 1.5rem;
}

.profile-header p {
  margin: 0.3rem 0 0 0;
  font-weight: 600;
  font-size: 0.95rem;
}

.profile-content {
  display: flex;
  gap: 1.5rem;
  align-items: center;
  justify-content: center;
  flex-wrap: nowrap;
  flex-direction: row;
}

.profile-content img {
  width: 110px;
  height: 110px;
  border-radius: 8px;
  object-fit: cover;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  flex-shrink: 0;
}

.profile .bio {
  flex: 1;
  text-align: left;
  font-size: 0.9rem;
  line-height: 1.4;
}

.profile .bio p {
  margin: 0.3rem 0;
  word-wrap: break-word;
}

@media (max-width: 500px) {
  .profile-content {
    flex-direction: column;
    align-items: center;
    text-align: center;
  }

  .profile-content img {
    width: 140px;
    height: 140px;
  }

  .profile .bio {
    font-size: 0.9rem;
  }
}
.label-sering {
  background: orange;
  color: white;
  font-size: 0.7rem;
  font-weight: bold;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  position: absolute;
  top: 10px;
  left: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}
.faq h2, .products h2, .payment-section h2 {
  font-size: 1.5rem;
  margin-bottom: 1rem;
  color: var(--accent-color);
}
.products .product-list {
  scroll-behavior: smooth;
  display: flex;
  gap: 1rem;
  overflow-x: auto;
  padding-bottom: 1rem;
  scroll-snap-type: x mandatory;
}
.product-list {
  scroll-snap-type: x mandatory;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch; /* Untuk iOS */
}
.products .product {
  position: relative;
  min-width: 200px;
  flex-shrink: 0;
  scroll-snap-align: start;
  border: 1px solid #ccc;
  border-radius: 10px;
  padding: 1rem;
  background: var(--card-bg);
  transition: transform 0.3s, box-shadow 0.3s;
  text-align: center;
}
.products .product:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 4px 15px rgba(0,0,0,0.15);
}
.products img {
  width: 80px;
  margin-bottom: 1rem;
  transition: transform 0.3s;
}
.products img:hover {
  transform: scale(1.1);
}
.price {
  font-weight: bold;
  color: #28a745;
}
.price span {
  font-size: 1rem;
}
button {
  background: var(--accent-color);
  color: white;
  border: none;
  padding: 0.7rem 1.2rem;
  border-radius: 5px;
  cursor: pointer;
  margin: 0.3rem;
  transition: all 0.3s;
  font-weight: 600;
  letter-spacing: 0.5px;
}
select {
  font-family: 'Poppins', sans-serif;
  font-size: 1rem;
  padding: 0.6rem 1rem;
  border-radius: 6px;
  border: 1px solid #ccc;
  background-color: var(--card-bg);
  color: var(--text-color);
  transition: all 0.3s ease;
  cursor: pointer;
}
select:focus {
  outline: none;
  border-color: var(--accent-color);
  box-shadow: 0 0 5px var(--accent-color);
}
button:hover {
  background: linear-gradient(45deg, #007BFF, #00c8ff);
  transform: translateY(-2px) scale(1.03);
}
button:active {
  transform: scale(0.95);
}
.payment-page {
  display: none;
  padding: 2rem;
  max-width: 500px;
  margin: 3rem auto;
  border: 1px solid #ccc;
  border-radius: 10px;
  background: var(--card-bg);
  text-align: center;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
.payment-options img[alt="DANA"] {
  width: auto;
  max-width: 90px;
  cursor: pointer;
  margin: 1rem;
  transition: transform 0.3s;
  object-fit: contain;
}
.payment-options img[alt="QRIS"] {
  width: auto;
  max-width: 70px;
  cursor: pointer;
  margin: 1rem;
  transition: transform 0.3s;
  object-fit: contain;
}
.payment-options img:hover {
  transform: scale(1.1);
}
.footer {
  display: none !important;
}
input[type="search"] {
  width: 100%;
  padding: 0.7rem;
  margin-top: 1rem;
  margin-bottom: 2rem;
  border-radius: 5px;
  border: 1px solid #ccc;
  font-size: 1rem;
}
.wa-fixed {
  position: fixed;
  left: 20px;
  top: 92%;
  transform: translateY(-50%);
  display: flex;
  align-items: center;
  background: #25d366;
  color: white;
  padding: 0.3rem 0.7rem;
  border-radius: 20px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.2);
  z-index: 1000;
  cursor: pointer;
  text-decoration: none;
  font-weight: 500;
  font-size: 0.75rem;
}
.wa-fixed img {
  width: 18px;
  height: 18px;
  margin-right: 0.4rem;
  object-fit: contain;
}
body::before {
  content: "";
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  z-index: -1;
  background: radial-gradient(circle at center, rgba(255,255,255,0.05), transparent 70%);
}
.blob-container {
  position: fixed;
  width: 100%;
  height: 100%;
  overflow: hidden;
  z-index: -1;
  top: 0;
  left: 0;
}
.blob {
  position: absolute;
  width: 300px;
  height: 300px;
  background: #00c8ff;
  opacity: 0.15;
  border-radius: 50%;
  filter: blur(80px);
  animation: moveBlobs 20s infinite alternate ease-in-out;
}
.blob:nth-child(2) {
  left: 60%;
  top: 30%;
  background: #007BFF;
  animation-delay: 5s;
}
@keyframes moveBlobs {
  0% {
    transform: translate(0, 0) scale(1);
  }
  100% {
    transform: translate(-100px, 100px) scale(1.2);
  }
}

#popup-confirm, #popup-alert {
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.5);
  align-items: center;
  justify-content: center;
  z-index: 9999;
  pointer-events: auto;
}
#popup-confirm .box, #popup-alert .box {
  background: var(--popup-bg);
  color: var(--text-color);
  transition: background-color 0.3s, color 0.3s;
  padding: 2rem;
  border-radius: 10px;
  max-width: 300px;
  width: 90%;
  text-align: center;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  animation: pop 0.3s ease;
}
#popup-promo {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 99999;
  backdrop-filter: blur(4px);
  animation: fadeIn 0.3s ease;
}

.promo-box {
  background: var(--card-bg);
  color: var(--text-color);
  padding: 2rem;
  border-radius: 16px;
  max-width: 320px;
  width: 90%;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
  text-align: center;
  position: relative;
  animation: slideUp 0.3s ease;
}
.promo-box h3 {
  margin-bottom: 0.8rem;
  font-size: 1.2rem;
}
.promo-box p {
  font-size: 0.95rem;
  margin-bottom: 1.5rem;
}
.promo-actions {
  display: flex;
  gap: 0.5rem;
  justify-content: center;
  flex-wrap: wrap;
}
.promo-btn {
  background: #007BFF;
  color: white;
  border: none;
  padding: 0.6rem 1.2rem;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.3s;
}
.promo-btn:hover {
  background: #00b7ff;
}
.promo-btn.cancel {
  background: #ccc;
  color: #333;
}
.promo-close {
  position: absolute;
  top: 10px;
  right: 14px;
  font-size: 1.2rem;
  cursor: pointer;
  color: var(--text-color);
}
@keyframes slideUp {
  from { transform: translateY(40px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
@keyframes fadeIn {
  from { background: rgba(0, 0, 0, 0); }
  to { background: rgba(0, 0, 0, 0.6); }
}
#popup-promo {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 99999;
}
.promo-box button {
  margin-top: 1rem;
  background: #007BFF;
  padding: 0.5rem 1rem;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
#toast {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: var(--accent-color);
  color: white;
  padding: 0.8rem 1.2rem;
  border-radius: 5px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.2);
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.3s, transform 0.3s;
  z-index: 9999;
  font-size: 0.85rem;
  pointer-events: none;
}
#toast.show {
  opacity: 1;
  transform: translateY(0);
}
@keyframes pop {
  from { transform: scale(0.7); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}
</style>
</head>
<body>
<div class="blob-container">
  <div class="blob"></div>
  <div class="blob"></div>
</div>

<header>
  <div>
    <h1 style="margin: 0;">Dika ID</h1>
    <p style="margin: 0; font-size: 0.9rem; font-weight: 500;">Solusi Digital Cepat & Aman</p>
  </div>
  <div class="theme-toggle" onclick="toggleTheme()">üåô</div>
</header>

<a href="https://wa.me/6283841442290" target="_blank" class="wa-fixed" id="wa-chat" aria-label="Chat WhatsApp">
  <img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/WhatsApp_icon.png" alt="WhatsApp" />
  Chat Admin
</a>

<div class="container" id="main-page">
  
  <div class="profile">
  <div class="profile-header">
    <h2>Dika Pamungkas</h2>
    <p><strong>Pemrograman & Web Developer</strong></p>
  </div>

  <div class="profile-content">
    <img src="https://iili.io/Fub8VGp.jpg" alt="Profile">
    <div class="bio">
      <p>üìç Jawa Tengah, Indonesia</p>
      <p>üì© dikaapamungkas9821@gmail.com</p>
      <p>üí° Teknologi Informasi Komunikasi</p>
    </div>
  </div>
</div>

  <div class="section faq">
    <h2>FAQ - Informasi Edukatif</h2>
    <h3>Apa Itu Panel Pterodactyl?</h3>
    <p>Panel Pterodactyl adalah platform manajemen server berbasis web yang memudahkan pengguna dalam mengelola server untuk berbagai kebutuhan seperti game server, bot WhatsApp, aplikasi, dan lain-lain.</p>
    <h3>Apa itu VPS DigitalOcean?</h3>
    <p>VPS (Virtual Private Server) DigitalOcean adalah layanan server virtual yang dapat digunakan untuk menjalankan berbagai aplikasi seperti bot WhatsApp, website, panel Pterodactyl, dan lain-lain.</p>
    <h3>Apa itu Bot WhatsApp?</h3>
    <p>Bot WhatsApp adalah program otomatis yang digunakan untuk membalas pesan, menjalankan perintah, atau memberikan layanan tertentu di WhatsApp tanpa campur tangan manual.</p>
  </div>
  
  <div class="section products" id="product-list">

  <input type="search" placeholder="Cari produk..." id="search" oninput="delayedSearch()" style="width: 100%; padding: 0.7rem; border-radius: 5px; border: 1px solid #ccc; font-size: 1rem;">
  
  <select id="filter-kategori" onchange="filterByKategori()" style="margin-bottom: 2rem; padding: 0.5rem; font-size: 1rem; border-radius: 5px;">
  <option value="">üîç Semua Kategori</option>
  <option value="public">Panel Server Public</option>
  <option value="private">Panel Server Private</option>
  <option value="vps">VPS Digital Ocean</option>
  <option value="bot">Pembuatan Bot Wa</option>
</select>
  
    <h2>Panel Server Public</h2>
    <div class="product-list" id="list-public"></div>

    <h2>Panel Server Private</h2>
    <div class="product-list" id="list-private"></div>

    <h2>VPS Digital Ocean</h2>
    <div class="product-list" id="list-vps"></div>

    <h2>Pembuatan Bot Wa</h2>
    <div class="product-list" id="list-bot"></div>

  </div>
</div>

<!-- HALAMAN PEMBAYARAN -->
<div class="payment-page" id="payment-page">
  <h2 id="item-kategori" style="margin: 0 0 0.3rem 0; color: var(--text-color); font-weight: 600;">-</h2>
<h2 id="item-title" style="margin: 0.3rem 0 1rem 0; color: var(--text-color); font-weight: 600;">-</h2>
  <h3 style="font-size:1.8rem; margin: 1.5rem 0; color:#00c8ff;">Rp<span id="total-price">0</span></h3>

  <p style="margin:1rem 0 0.5rem 0;">Pilih metode pembayaran:</p>
  
  <div class="payment-options" style="display:flex; justify-content:center; flex-wrap:wrap;">
    <img src="https://iili.io/FTuZHOJ.png" alt="DANA" onclick="selectPayment('DANA')">
    <img src="https://iili.io/FTuZ9Ra.png" alt="QRIS" onclick="selectPayment('QRIS')">
  </div>

  <div id="payment-info" style="margin-top:1rem;"></div>

  <button id="confirm-btn" onclick="confirmPayment()">Selesai Bayar</button>
  <button onclick="goBack()" style="background:red;">Batalkan</button>
</div>

<div id="popup-alert">
  <div class="box">
    <h3>Perhatian!</h3>
    <p id="alert-message">Pesan muncul di sini.</p>
    <button style="background:#007BFF;" onclick="closeAlert()">Oke</button>
  </div>
</div>

<div id="popup-confirm">
  <div class="box">
    <h3>Konfirmasi Pembayaran</h3>
    <p>Apakah Anda yakin sudah melakukan pembayaran?</p>
    <div style="margin-top:1.5rem;">
      <button style="background:#28a745;" onclick="proceedWhatsApp()">Ya, Lanjut</button>
      <button style="background:#dc3545;" onclick="closePopup()">Batalkan</button>
    </div>
  </div>
</div>

<div id="confirmation-page" class="payment-page" style="display:none;">
  <h2 style="color:green;">Terima kasih telah mengkonfirmasi pembayaran Anda!</h2>
  <p style="margin: 1rem 0 2rem;">Pembayaran Anda akan segera diproses.</p>
  <button onclick="returnToMain()">Kembali</button>
</div>

<div id="toast">Nomor berhasil disalin!</div>
<div id="popup-promo" class="popup-promo" style="display: none;">
  <div class="promo-box">
    <span class="promo-close" onclick="closePromo()">√ó</span>
    <h3>üéâ Promo Spesial Bulan Juni</h3>
    <p id="promo-content">Lihat produk dengan diskon terbaik!</p>
    <div class="promo-actions">
      <button class="promo-btn" onclick="goToDiskonProduk()">üî• Saya Mau</button>
      <button class="promo-btn cancel" onclick="closePromo()">Tutup</button>
    </div>
  </div>
</div>

<script>
// edit produk disini
const produkList = [
  { kategori: 'public', nama: 'RAM 1GB CPU 30%', harga: 1000, diskon: 0 },
  { kategori: 'public', nama: 'RAM 2GB CPU 60%', harga: 2000, diskon: 0 },
  { kategori: 'public', nama: 'RAM 3GB CPU 90%', harga: 3000, diskon: 0 },
  { kategori: 'public', nama: 'UNLIMITED RAM&CPU', harga: 7000, diskon: 0 },
  { kategori: 'public', nama: 'RESELLER PANEL', harga: 10000, diskon: 0 },
  { kategori: 'public', nama: 'OWNER RESELLER PANEL', harga: 15000, diskon: 0 },
  { kategori: 'public', nama: 'ADMIN PANEL', harga: 20000, diskon: 0 },
  { kategori: 'public', nama: 'PARTNER PANEL', harga: 25000, diskon: 0 },

  { kategori: 'private', nama: 'RAM 1GB CPU 30%', harga: 2000, diskon: 0 },
  { kategori: 'private', nama: 'RAM 2GB CPU 60%', harga: 3000, diskon: 0 },
  { kategori: 'private', nama: 'RAM 3GB CPU 90%', harga: 4000, diskon: 0 },
  { kategori: 'private', nama: 'UNLIMITED RAM&CPU', harga: 10000, diskon: 0 },
  { kategori: 'private', nama: 'RESELLER PANEL', harga: 15000, diskon: 0 },
  { kategori: 'private', nama: 'OWNER RESELLER PANEL', harga: 20000, diskon: 0 },

  { kategori: 'vps', nama: 'RAM 8GB CORE 4', harga: 45000, diskon: 0 },
  { kategori: 'vps', nama: 'RAM 16GB CORE 4', harga: 55000, diskon: 0 },

  { kategori: 'bot', nama: 'MASA AKTIF 1BULAN', harga: 15000, diskon: 0 },
  { kategori: 'bot', nama: 'MASA AKTIF 2BULAN', harga: 30000, diskon: 0 },
  { kategori: 'bot', nama: 'MASA AKTIF PERMANEN', harga: 50000, diskon: 20 }
];

const kategoriMap = {
  public: 'SERVER PUBLIC',
  private: 'SERVER PRIVATE',
  vps: 'DIGITAL OCEAN',
  bot: 'BOT WA'
};

let selectedProduct = '';
let selectedPrice = 0;
let selectedPayment = '';
let selectedKategori = '';
let darkMode = false;
let produkPromoId = '';

const altIconMap = {
  public: 'Pterodactyl',
  private: 'Pterodactyl',
  vps: 'Digital Ocean',
  bot: 'Bot WhatsApp'
};

const iconMap = {
  public: 'https://iili.io/FTuUKvV.md.png', 
  private: 'https://iili.io/FTuUKvV.md.png',
  vps: 'https://iili.io/FTuUFYQ.png',
  bot: 'https://iili.io/FT0en4t.png'
};

function renderProduk() {
  const containerPublic = document.getElementById('list-public');
  const containerPrivate = document.getElementById('list-private');
  const containerVps = document.getElementById('list-vps');
  const containerBot = document.getElementById('list-bot');

  produkList.forEach(p => {
  const el = document.createElement('div');
  el.className = 'product';

  const hargaDiskon = p.diskon ? p.harga - (p.harga * p.diskon / 100) : p.harga;
  const hargaAsli = p.diskon ? `<span style="text-decoration: line-through; color: gray; font-size: 0.9rem;">Rp${formatCurrency(p.harga)}</span>` : '';
  const labelDiskon = p.diskon ? `<div style="position:absolute; top:10px; right:10px; background:red; color:white; padding:2px 6px; border-radius:4px; font-size:0.75rem;">-${p.diskon}%</div>` : '';

  el.innerHTML = `
    ${labelDiskon}
    <img src="${iconMap[p.kategori]}" alt="${altIconMap[p.kategori] || 'Icon'}">
    <h3>${p.nama}</h3>
    <p class="price">${hargaAsli} <br> <strong style="color:#28a745;">Rp<span>${formatCurrency(hargaDiskon)}</span></strong></p>
    <button onclick="selectProduct('${p.nama}', ${hargaDiskon}, '${p.kategori}')" data-title="${p.nama}">Beli</button>
  `;

  if (p.kategori === 'public') containerPublic.appendChild(el);
  if (p.kategori === 'private') containerPrivate.appendChild(el);
  if (p.kategori === 'vps') containerVps.appendChild(el);
  if (p.kategori === 'bot') containerBot.appendChild(el);
});
}

function toggleTheme() {
  darkMode = !darkMode;
  document.documentElement.style.setProperty('--bg-color', darkMode ? '#121212' : '#fff');
  document.documentElement.style.setProperty('--text-color', darkMode ? '#fff' : '#000');
  document.documentElement.style.setProperty('--card-bg', darkMode ? '#1e1e1e' : '#f9f9f9');
  document.documentElement.style.setProperty('--footer-bg', darkMode ? '#1e1e1e' : '#f0f0f0');
  document.documentElement.style.setProperty('--popup-bg', darkMode ? '#1e1e1e' : '#fff');
  document.getElementById('search').style.backgroundColor = darkMode ? '#1e1e1e' : '#fff';
  document.getElementById('search').style.color = darkMode ? '#fff' : '#000';
  document.getElementById('search').style.border = darkMode ? '1px solid #444' : '1px solid #ccc';
  document.getElementById('filter-kategori').style.backgroundColor = darkMode ? '#1e1e1e' : '#fff';
  document.getElementById('filter-kategori').style.color = darkMode ? '#fff' : '#000';
  document.getElementById('filter-kategori').style.border = darkMode ? '1px solid #444' : '1px solid #ccc';
  
  document.querySelector('.theme-toggle').innerText = darkMode ? '‚òÄÔ∏è' : 'üåô';
  localStorage.setItem('darkMode', darkMode ? 'enabled' : 'disabled');
}

function applyTheme() {
  document.documentElement.style.setProperty('--bg-color', darkMode ? '#121212' : '#fff');
  document.documentElement.style.setProperty('--text-color', darkMode ? '#fff' : '#000');
  document.documentElement.style.setProperty('--card-bg', darkMode ? '#1e1e1e' : '#f9f9f9');
  document.documentElement.style.setProperty('--footer-bg', darkMode ? '#1e1e1e' : '#f0f0f0');
  document.documentElement.style.setProperty('--popup-bg', darkMode ? '#1e1e1e' : '#fff');
  document.getElementById('search').style.backgroundColor = darkMode ? '#1e1e1e' : '#fff';
  document.getElementById('search').style.color = darkMode ? '#fff' : '#000';
  document.getElementById('search').style.border = darkMode ? '1px solid #444' : '1px solid #ccc';
  document.getElementById('filter-kategori').style.backgroundColor = darkMode ? '#1e1e1e' : '#fff';
  document.getElementById('filter-kategori').style.color = darkMode ? '#fff' : '#000';
  document.getElementById('filter-kategori').style.border = darkMode ? '1px solid #444' : '1px solid #ccc';
  
  document.querySelector('.theme-toggle').innerText = darkMode ? '‚òÄÔ∏è' : 'üåô';
}

function selectProduct(product, price, kategori = '') {
  selectedProduct = product;
  selectedPrice = price;
  selectedKategori = kategori;

  const kategoriTampil = kategoriMap[kategori] || kategori;

  const views = JSON.parse(localStorage.getItem('productViews')) || {};
  views[product] = (views[product] || 0) + 1;
  localStorage.setItem('productViews', JSON.stringify(views));

  document.getElementById('item-kategori').innerText = kategoriTampil;
  document.getElementById('item-title').innerText = product;
  document.getElementById('total-price').innerText = formatCurrency(price);

  document.getElementById('main-page').style.display = 'none';
  document.getElementById('payment-page').style.display = 'block';

  updateSeringDilihatLabel();
}

function showPromoPopup() {
  const produkDiskon = produkList.filter(p => p.diskon && p.diskon > 0);
  if (produkDiskon.length === 0) return;

  const best = produkDiskon.sort((a, b) => b.diskon - a.diskon)[0];
  const kategoriId = `list-${best.kategori}`;

  produkPromoId = best.nama;

  const isi = `Diskon ${best.diskon}% untuk <strong>${best.nama}</strong> di kategori <strong>${kategoriMap[best.kategori]}</strong>!`;
  document.getElementById('promo-content').innerHTML = isi;
  document.getElementById('popup-promo').style.display = 'flex';
}

function goToDiskonProduk() {
  closePromo();

  const produkElements = document.querySelectorAll('.product');

  produkElements.forEach(p => {
    const title = p.querySelector('button')?.getAttribute('data-title');
    if (title === produkPromoId) {
      p.scrollIntoView({ behavior: 'smooth', block: 'center' });
      p.style.boxShadow = '0 0 15px 3px #00c8ff';
      setTimeout(() => {
        p.style.boxShadow = '';
      }, 2000);
    }
  });
}

function closePromo() {
  document.getElementById('popup-promo').style.display = 'none';
  localStorage.setItem('promoSeen', 'true');
}

function updateSeringDilihatLabel() {
  const views = JSON.parse(localStorage.getItem('productViews')) || {};
  const productElements = document.querySelectorAll('.product');

  let maxViews = 0;
  let topProduct = '';

  for (const [product, count] of Object.entries(views)) {
    if (count > maxViews) {
      maxViews = count;
      topProduct = product;
    }
  }

  document.querySelectorAll('.label-sering').forEach(el => el.remove());

  productElements.forEach(p => {
    const button = p.querySelector('button');
    const title = button?.getAttribute('data-title') || '';

    if (title === topProduct && maxViews > 0) {
      const label = document.createElement('span');
      label.className = 'label-sering';
      label.innerText = 'Sering Dilihat';
      p.appendChild(label);
    }
  });
}

function filterByKategori() {
  const value = document.getElementById('filter-kategori').value;
  const sectionMap = {
    public: 'list-public',
    private: 'list-private',
    vps: 'list-vps',
    bot: 'list-bot'
  };

  for (const [key, id] of Object.entries(sectionMap)) {
    const list = document.getElementById(id);
    const title = list?.previousElementSibling; // H2 sebelum div
    const show = value === '' || value === key;
    
    if (list) list.style.display = show ? 'flex' : 'none';
    if (title) title.style.display = show ? 'block' : 'none';
  }
}

function selectPayment(method) {
  selectedPayment = method;
  let info = '';
  if (method === 'DANA') {
  info = `<p>Nomor DANA: <strong id="nomor-rekening">081227434223</strong></p>
  <button onclick="copyRekening()">Copy Rekening</button>`;
  } else if (method === 'QRIS') {
    info = `<img src="https://iili.io/FTuP3ml.md.jpg" alt="QRIS" style="width:200px;"><br>
    <a href="https://iili.io/FTuP3ml.md.jpg" download><button>Download QRIS</button></a>`;
  }
  document.getElementById('payment-info').innerHTML = info;
}

function copyRekening() {
  const rekening = document.getElementById('nomor-rekening').innerText;

  if (navigator.clipboard) {
    navigator.clipboard.writeText(rekening)
      .then(() => showToast('Nomor rekening berhasil disalin!'))
      .catch(() => showAlert('Gagal menyalin, coba manual.'));
  } else {
    const tempInput = document.createElement('input');
    tempInput.value = rekening;
    document.body.appendChild(tempInput);
    tempInput.select();
    document.execCommand('copy');
    document.body.removeChild(tempInput);
    showToast('Nomor rekening berhasil disalin!');
  }
}

function showToast(message) {
  const toast = document.getElementById('toast');
  toast.innerText = message;
  toast.classList.add('show');
  
  setTimeout(() => {
    toast.classList.remove('show');
  }, 2500);
}

function confirmPayment() {
  if (!selectedPayment) {
    showAlert('Pilih metode pembayaran dan lakukan pembayaran!');
    return;
  }
  document.getElementById('popup-confirm').style.display = 'flex';
}

function formatCurrency(amount) {
  amount = Number(amount) || 0;
  return amount.toLocaleString('id-ID');
}

function proceedWhatsApp() {
  if (!selectedProduct || !selectedPayment) {
    showAlert('Lengkapi pesanan sebelum konfirmasi!');
    return;
  }

  closePopup();

  const kategoriTampil = kategoriMap[selectedKategori] || selectedKategori;

  const message = `Halo Admin, Saya telah melakukan pembayaran untuk pesanan berikut:

Produk: ${selectedProduct}
Kategori: ${kategoriTampil}
Harga: Rp${formatCurrency(selectedPrice)}
Payment: ${selectedPayment}

Mohon konfirmasinya, terima kasih`;

  navigator.clipboard.writeText(message);

  document.getElementById('main-page').style.display = 'none';
  document.getElementById('payment-page').style.display = 'none';
  document.getElementById('confirmation-page').style.display = 'block';

  setTimeout(() => {
    window.location.href = `https://wa.me/6283841442290?text=${encodeURIComponent(message)}`;
  }, 100);
}

window.addEventListener('DOMContentLoaded', () => {
  const savedTheme = localStorage.getItem('darkMode');
  if (savedTheme) {
    darkMode = savedTheme === 'enabled';
  }
  applyTheme();

  renderProduk();
  
  updateSeringDilihatLabel();
  
  if (!localStorage.getItem('promoSeen')) {
  showPromoPopup();
}

  const confirmed = localStorage.getItem('hasConfirmed');
  if (confirmed === 'true') {
    document.getElementById('main-page').style.display = 'none';
    document.getElementById('payment-page').style.display = 'none';
    document.getElementById('confirmation-page').style.display = 'block';
    localStorage.removeItem('hasConfirmed');
  }
});

function returnToMain() {
  document.getElementById('confirmation-page').style.display = 'none';
  document.getElementById('main-page').style.display = 'block';
  
  setTimeout(updateSeringDilihatLabel, 50);
}

function closePopup() {
  document.getElementById('popup-confirm').style.display = 'none';
}

function goBack() {
  document.getElementById('payment-page').style.display = 'none';
  document.getElementById('main-page').style.display = 'block';
  
  setTimeout(updateSeringDilihatLabel, 50);
}

function showAlert(message) {
  document.getElementById('alert-message').innerText = message;
  document.getElementById('popup-alert').style.display = 'flex';
}

function closeAlert() {
  document.getElementById('popup-alert').style.display = 'none';
}

let searchTimeout;

function delayedSearch() {
  clearTimeout(searchTimeout);
  searchTimeout = setTimeout(() => {
    doSearch();
  }, 500);
}

function doSearch() {
  const keyword = document.getElementById('search').value.toLowerCase().trim();
  const products = document.querySelectorAll('.product');
  let found = 0;

  products.forEach(p => {
    const title = p.querySelector('h3')?.innerText.toLowerCase() || '';
    const category = p.querySelector('img')?.alt.toLowerCase() || '';
    const match = title.includes(keyword) || category.includes(keyword);
    p.style.display = match ? 'block' : 'none';
    if (match) found++;
  });

  if (keyword && found === 0) {
    showAlert('Produk tidak ditemukan');
  }
}
</script>

</body>
</html>

<!-- dika -->